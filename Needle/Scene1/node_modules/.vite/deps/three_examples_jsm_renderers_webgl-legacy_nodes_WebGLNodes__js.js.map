{
  "version": 3,
  "sources": ["../../@needle-tools/engine/node_modules/three/examples/jsm/renderers/webgl-legacy/nodes/WebGLNodes.js"],
  "sourcesContent": ["import { nodeFrame, WebGLNodeBuilder } from './WebGLNodeBuilder.js';\r\nimport { Material } from 'three';\r\n\r\nconst builders = new WeakMap();\r\n\r\nMaterial.prototype.onBuild = function ( object, parameters, renderer ) {\r\n\r\n\tconst material = this;\r\n\r\n\tif ( material.isNodeMaterial === true ) {\r\n\r\n\t\tlet newBuilder;\r\n\t\ttry {\r\n\r\n\t\t\tnewBuilder = new WebGLNodeBuilder( object, renderer, parameters, material ).build();\r\n\t\t\tbuilders.set( material, newBuilder );\r\n\r\n\t\t} catch ( e ) {\r\n\r\n\t\t\tconsole.error( 'Material.prototype.onBuild: ', e );\r\n\r\n\t\t}\r\n\r\n\t\t// console.log( 'Material.prototype.onBuild: new builder', this, newBuilder );\r\n\r\n\t}\r\n\r\n};\r\n\r\nMaterial.prototype.onBeforeRender = function ( renderer, scene, camera, geometry, object ) {\r\n\r\n\tconst nodeBuilder = builders.get( this );\r\n\r\n\t// if ( this.isNodeMaterial )\r\n\t//\tconsole.log( 'Material.prototype.onBeforeRender', this, nodeBuilder );\r\n\r\n\tif ( nodeBuilder !== undefined ) {\r\n\r\n\t\tnodeFrame.material = this;\r\n\t\tnodeFrame.camera = camera;\r\n\t\tnodeFrame.object = object;\r\n\t\tnodeFrame.renderer = renderer;\r\n\t\tnodeFrame.scene = scene;\r\n\t\tnodeFrame.geometry = geometry;\r\n\r\n\t\tconst updateNodes = nodeBuilder.updateNodes;\r\n\r\n\t\tif ( updateNodes.length > 0 ) {\r\n\r\n\t\t\t// force refresh material uniforms\r\n\t\t\trenderer.state.useProgram( null );\r\n\r\n\t\t\t//this.uniformsNeedUpdate = true;\r\n\r\n\t\t\tfor ( const node of updateNodes ) {\r\n\r\n\t\t\t\tnodeFrame.updateNode( node );\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n};\r\n"],
  "mappings": ";;;;;;;;;;AAGA,IAAM,WAAW,oBAAI,QAAQ;AAE7B,SAAS,UAAU,UAAU,SAAW,QAAQ,YAAY,UAAW;AAEtE,QAAM,WAAW;AAEjB,MAAK,SAAS,mBAAmB,MAAO;AAEvC,QAAI;AACJ,QAAI;AAEH,mBAAa,IAAI,iBAAkB,QAAQ,UAAU,YAAY,QAAS,EAAE,MAAM;AAClF,eAAS,IAAK,UAAU,UAAW;AAAA,IAEpC,SAAU,GAAR;AAED,cAAQ,MAAO,gCAAgC,CAAE;AAAA,IAElD;AAAA,EAID;AAED;AAEA,SAAS,UAAU,iBAAiB,SAAW,UAAU,OAAO,QAAQ,UAAU,QAAS;AAE1F,QAAM,cAAc,SAAS,IAAK,IAAK;AAKvC,MAAK,gBAAgB,QAAY;AAEhC,cAAU,WAAW;AACrB,cAAU,SAAS;AACnB,cAAU,SAAS;AACnB,cAAU,WAAW;AACrB,cAAU,QAAQ;AAClB,cAAU,WAAW;AAErB,UAAM,cAAc,YAAY;AAEhC,QAAK,YAAY,SAAS,GAAI;AAG7B,eAAS,MAAM,WAAY,IAAK;AAIhC,iBAAY,QAAQ,aAAc;AAEjC,kBAAU,WAAY,IAAK;AAAA,MAE5B;AAAA,IAED;AAAA,EAED;AAED;",
  "names": []
}
