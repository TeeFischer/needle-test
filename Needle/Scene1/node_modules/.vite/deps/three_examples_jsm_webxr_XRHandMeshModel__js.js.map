{
  "version": 3,
  "sources": ["../../@needle-tools/engine/node_modules/three/examples/jsm/webxr/XRHandMeshModel.js"],
  "sourcesContent": ["import { GLTFLoader } from '../loaders/GLTFLoader.js';\r\n\r\nconst DEFAULT_HAND_PROFILE_PATH = 'https://cdn.jsdelivr.net/npm/@webxr-input-profiles/assets@1.0/dist/profiles/generic-hand/';\r\n\r\nclass XRHandMeshModel {\r\n\r\n\tconstructor( handModel, controller, path, handedness, loader = null, onLoad = null ) {\r\n\r\n\t\tthis.controller = controller;\r\n\t\tthis.handModel = handModel;\r\n\r\n\t\tthis.bones = [];\r\n\r\n\t\tif ( loader === null ) {\r\n\r\n\t\t\tloader = new GLTFLoader();\r\n\t\t\tloader.setPath( path || DEFAULT_HAND_PROFILE_PATH );\r\n\r\n\t\t}\r\n\r\n\t\tloader.load( `${handedness}.glb`, gltf => {\r\n\r\n\t\t\tconst object = gltf.scene.children[ 0 ];\r\n\t\t\tthis.handModel.add( object );\r\n\t\t\t// NEEDLE: The hand mesh should by default inherit layers.\r\n\t\t\tobject.layers.mask = this.handModel.layers.mask;\r\n\r\n\t\t\tconst mesh = object.getObjectByProperty( 'type', 'SkinnedMesh' );\r\n\t\t\tmesh.frustumCulled = false;\r\n\t\t\tmesh.castShadow = true;\r\n\t\t\tmesh.receiveShadow = true;\r\n\r\n\t\t\tconst joints = [\r\n\t\t\t\t'wrist',\r\n\t\t\t\t'thumb-metacarpal',\r\n\t\t\t\t'thumb-phalanx-proximal',\r\n\t\t\t\t'thumb-phalanx-distal',\r\n\t\t\t\t'thumb-tip',\r\n\t\t\t\t'index-finger-metacarpal',\r\n\t\t\t\t'index-finger-phalanx-proximal',\r\n\t\t\t\t'index-finger-phalanx-intermediate',\r\n\t\t\t\t'index-finger-phalanx-distal',\r\n\t\t\t\t'index-finger-tip',\r\n\t\t\t\t'middle-finger-metacarpal',\r\n\t\t\t\t'middle-finger-phalanx-proximal',\r\n\t\t\t\t'middle-finger-phalanx-intermediate',\r\n\t\t\t\t'middle-finger-phalanx-distal',\r\n\t\t\t\t'middle-finger-tip',\r\n\t\t\t\t'ring-finger-metacarpal',\r\n\t\t\t\t'ring-finger-phalanx-proximal',\r\n\t\t\t\t'ring-finger-phalanx-intermediate',\r\n\t\t\t\t'ring-finger-phalanx-distal',\r\n\t\t\t\t'ring-finger-tip',\r\n\t\t\t\t'pinky-finger-metacarpal',\r\n\t\t\t\t'pinky-finger-phalanx-proximal',\r\n\t\t\t\t'pinky-finger-phalanx-intermediate',\r\n\t\t\t\t'pinky-finger-phalanx-distal',\r\n\t\t\t\t'pinky-finger-tip',\r\n\t\t\t];\r\n\r\n\t\t\tjoints.forEach( jointName => {\r\n\r\n\t\t\t\tconst bone = object.getObjectByName( jointName );\r\n\r\n\t\t\t\tif ( bone !== undefined ) {\r\n\r\n\t\t\t\t\tbone.jointName = jointName;\r\n\r\n\t\t\t\t} else {\r\n\r\n\t\t\t\t\tconsole.warn( `Couldn't find ${jointName} in ${handedness} hand mesh` );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tthis.bones.push( bone );\r\n\r\n\t\t\t} );\r\n\r\n\t\t\tif ( onLoad ) onLoad( object );\r\n\r\n\t\t} );\r\n\r\n\t}\r\n\r\n\tupdateMesh() {\r\n\r\n\t\t// XR Joints\r\n\t\tconst XRJoints = this.controller.joints;\r\n\r\n\t\tfor ( let i = 0; i < this.bones.length; i ++ ) {\r\n\r\n\t\t\tconst bone = this.bones[ i ];\r\n\r\n\t\t\tif ( bone ) {\r\n\r\n\t\t\t\tconst XRJoint = XRJoints[ bone.jointName ];\r\n\r\n\t\t\t\tif ( XRJoint.visible ) {\r\n\r\n\t\t\t\t\tconst position = XRJoint.position;\r\n\r\n\t\t\t\t\tbone.position.copy( position );\r\n\t\t\t\t\tbone.quaternion.copy( XRJoint.quaternion );\r\n\t\t\t\t\t// bone.scale.setScalar( XRJoint.jointRadius || defaultRadius );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n}\r\n\r\nexport { XRHandMeshModel };\r\n"],
  "mappings": ";;;;;;;;AAEA,IAAM,4BAA4B;AAElC,IAAM,kBAAN,MAAsB;AAAA,EAErB,YAAa,WAAW,YAAY,MAAM,YAAY,SAAS,MAAM,SAAS,MAAO;AAEpF,SAAK,aAAa;AAClB,SAAK,YAAY;AAEjB,SAAK,QAAQ,CAAC;AAEd,QAAK,WAAW,MAAO;AAEtB,eAAS,IAAI,WAAW;AACxB,aAAO,QAAS,QAAQ,yBAA0B;AAAA,IAEnD;AAEA,WAAO,KAAM,GAAG,kBAAkB,UAAQ;AAEzC,YAAM,SAAS,KAAK,MAAM,SAAU,CAAE;AACtC,WAAK,UAAU,IAAK,MAAO;AAE3B,aAAO,OAAO,OAAO,KAAK,UAAU,OAAO;AAE3C,YAAM,OAAO,OAAO,oBAAqB,QAAQ,aAAc;AAC/D,WAAK,gBAAgB;AACrB,WAAK,aAAa;AAClB,WAAK,gBAAgB;AAErB,YAAM,SAAS;AAAA,QACd;AAAA,QACA;AAAA,QACA;AAAA,QACA;AAAA,QACA;AAAA,QACA;AAAA,QACA;AAAA,QACA;AAAA,QACA;AAAA,QACA;AAAA,QACA;AAAA,QACA;AAAA,QACA;AAAA,QACA;AAAA,QACA;AAAA,QACA;AAAA,QACA;AAAA,QACA;AAAA,QACA;AAAA,QACA;AAAA,QACA;AAAA,QACA;AAAA,QACA;AAAA,QACA;AAAA,QACA;AAAA,MACD;AAEA,aAAO,QAAS,eAAa;AAE5B,cAAM,OAAO,OAAO,gBAAiB,SAAU;AAE/C,YAAK,SAAS,QAAY;AAEzB,eAAK,YAAY;AAAA,QAElB,OAAO;AAEN,kBAAQ,KAAM,iBAAiB,gBAAgB,sBAAuB;AAAA,QAEvE;AAEA,aAAK,MAAM,KAAM,IAAK;AAAA,MAEvB,CAAE;AAEF,UAAK;AAAS,eAAQ,MAAO;AAAA,IAE9B,CAAE;AAAA,EAEH;AAAA,EAEA,aAAa;AAGZ,UAAM,WAAW,KAAK,WAAW;AAEjC,aAAU,IAAI,GAAG,IAAI,KAAK,MAAM,QAAQ,KAAO;AAE9C,YAAM,OAAO,KAAK,MAAO,CAAE;AAE3B,UAAK,MAAO;AAEX,cAAM,UAAU,SAAU,KAAK,SAAU;AAEzC,YAAK,QAAQ,SAAU;AAEtB,gBAAM,WAAW,QAAQ;AAEzB,eAAK,SAAS,KAAM,QAAS;AAC7B,eAAK,WAAW,KAAM,QAAQ,UAAW;AAAA,QAG1C;AAAA,MAED;AAAA,IAED;AAAA,EAED;AAED;",
  "names": []
}
